<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>An alternative spread function -- conceived for insects — spread3 • SpaDES.tools</title>

<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script>

<!-- sticky kit -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>



<meta property="og:title" content="An alternative spread function -- conceived for insects — spread3" />

<meta property="og:description" content="This is built with spread2 and is still experimental.
This one differs from other attempts in that it treats the advection and
dispersal as mathematical vectors that are added together.
They are &quot;rounded&quot; to pixel centres." />
<meta name="twitter:card" content="summary" />



<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->


  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">SpaDES.tools</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.3.2</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/PredictiveEcology/SpaDES.tools">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      
      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>An alternative spread function -- conceived for insects</h1>
    <small class="dont-index">Source: <a href='https://github.com/PredictiveEcology/SpaDES.tools/blob/master/R/spread3.R'><code>R/spread3.R</code></a></small>
    <div class="hidden name"><code>spread3.Rd</code></div>
    </div>

    <div class="ref-description">
    
    <p>This is built with <code><a href='spread2.html'>spread2</a></code> and is still experimental.
This one differs from other attempts in that it treats the advection and
dispersal as mathematical vectors that are added together.
They are "rounded" to pixel centres.</p>
    
    </div>

    <pre class="usage"><span class='fu'>spread3</span>(<span class='no'>start</span>, <span class='no'>rasQuality</span>, <span class='no'>rasAbundance</span>, <span class='no'>advectionDir</span>, <span class='no'>advectionMag</span>,
  <span class='no'>meanDist</span>, <span class='kw'>plot.it</span> <span class='kw'>=</span> <span class='fl'>2</span>, <span class='kw'>minNumAgents</span> <span class='kw'>=</span> <span class='fl'>50</span>,
  <span class='kw'>verbose</span> <span class='kw'>=</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/options'>getOption</a></span>(<span class='st'>"LandR.verbose"</span>, <span class='fl'>0</span>), <span class='kw'>saveStack</span> <span class='kw'>=</span> <span class='kw'>NULL</span>)</pre>
    
    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>start</th>
      <td><p>Raster indices from which to initiate dispersal</p></td>
    </tr>
    <tr>
      <th>rasQuality</th>
      <td><p>A raster with habitat quality. Currently, must
be scaled from 0 to 1, i.e., a probability of "settling"</p></td>
    </tr>
    <tr>
      <th>rasAbundance</th>
      <td><p>A raster where each pixel represents the number
of "agents" or pseudo-agents contained. This number of agents, will
be spread horizontally, and distributed from each pixel
that contains a non-zero non NA value.</p></td>
    </tr>
    <tr>
      <th>advectionDir</th>
      <td><p>A single number or <code>RasterLayer</code> in degrees
from North = 0 (though it will use radians if all values are
<code>abs(advectionDir) &gt; 2 * pi)</code>. This indicates
the direction of advective forcing (i.e., wind).</p></td>
    </tr>
    <tr>
      <th>advectionMag</th>
      <td><p>A single number or <code>RasterLayer</code> in distance units of the
<code>rasQuality</code>, e.g., meters, indicating the relative forcing that will
occur. It is imposed on the total event, i.e., if the <code>meanDist</code> is
<code>10000</code>, and <code>advectionMag</code> is <code>5000</code>, then the expected
distance (i.e., 63% of agents) will have settled by <code>15000</code> map units.</p></td>
    </tr>
    <tr>
      <th>meanDist</th>
      <td><p>A single number indicating the mean distance parameter in map units
(not pixels), for a negative exponential distribution
dispersal kernel (e.g., <code>dexp</code>). This will mean that 63<!-- % of agents will have -->
settled at this <code>meanDist</code> (still experimental)</p></td>
    </tr>
    <tr>
      <th>plot.it</th>
      <td><p>Numeric. With increasing numbers above 0, there will be plots
produced during iterations. Currently, only 0, 1, or 2+ are distinct.</p></td>
    </tr>
    <tr>
      <th>minNumAgents</th>
      <td><p>Single numeric indicating the minimum number of agents
to consider all dispersing finished. Default is 50</p></td>
    </tr>
    <tr>
      <th>verbose</th>
      <td><p>Numeric. With increasing numbers above 0, there will be more
messages produced. Currently, only 0, 1, or 2+ are distinct.</p></td>
    </tr>
    <tr>
      <th>saveStack</th>
      <td><p>If provided as a character string, it will save each iteration
as part of a <code>rasterStack</code> to disk upon exit.</p></td>
    </tr>
    </table>
    
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>A <code>data.table</code> with all information used during the spreading</p>
    

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'>  <span class='co'>#########################################################</span>
  <span class='co'># Simple case, no variation in rasQuality, numeric advectionDir and advectionMag</span>
  <span class='co'>#########################################################</span>
  <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/library'>library</a></span>(<span class='no'>raster</span>)
  <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/library'>library</a></span>(<span class='no'>quickPlot</span>)
  <span class='no'>maxDim</span> <span class='kw'>&lt;-</span> <span class='fl'>10000</span>
  <span class='no'>ras</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>raster</span><span class='kw ns'>::</span><span class='fu'><a href='https://www.rdocumentation.org/packages/raster/topics/raster'>raster</a></span>(<span class='fu'><a href='https://www.rdocumentation.org/packages/raster/topics/extent'>extent</a></span>(<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/c'>c</a></span>(<span class='fl'>0</span>, <span class='no'>maxDim</span>, <span class='fl'>0</span>, <span class='no'>maxDim</span>)), <span class='kw'>res</span> <span class='kw'>=</span> <span class='fl'>100</span>, <span class='kw'>vals</span> <span class='kw'>=</span> <span class='fl'>0</span>)
  <span class='no'>rasQuality</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/raster/topics/raster'>raster</a></span>(<span class='no'>ras</span>)
  <span class='no'>rasQuality</span>[] <span class='kw'>&lt;-</span> <span class='fl'>1</span>
  <span class='no'>rasAbundance</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/raster/topics/raster'>raster</a></span>(<span class='no'>rasQuality</span>)
  <span class='no'>rasAbundance</span>[] <span class='kw'>&lt;-</span> <span class='fl'>0</span>
  <span class='co'># startPixel &lt;- middlePixel(rasAbundance)</span>
  <span class='no'>startPixel</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/sample'>sample</a></span>(<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/seq'>seq</a></span>(<span class='fu'><a href='https://www.rdocumentation.org/packages/raster/topics/ncell'>ncell</a></span>(<span class='no'>rasAbundance</span>)), <span class='fl'>30</span>)
  <span class='no'>rasAbundance</span>[<span class='no'>startPixel</span>] <span class='kw'>&lt;-</span> <span class='fl'>1000</span>
  <span class='no'>advectionDir</span> <span class='kw'>&lt;-</span> <span class='fl'>70</span>
  <span class='no'>advectionMag</span> <span class='kw'>&lt;-</span> <span class='fl'>4</span> * <span class='fu'><a href='https://www.rdocumentation.org/packages/raster/topics/resolution'>res</a></span>(<span class='no'>rasAbundance</span>)[<span class='fl'>1</span>]
  <span class='no'>meanDist</span> <span class='kw'>&lt;-</span> <span class='fl'>2600</span>

   <span class='kw'>if</span> (<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/interactive'>interactive</a></span>()) {
     <span class='co'># Test the dispersal kernel -- create a function</span>
     <span class='no'>plotDispersalKernel</span> <span class='kw'>&lt;-</span> <span class='kw'>function</span>(<span class='no'>out</span>, <span class='no'>meanAdvectionMag</span>) {
       <span class='no'>out</span>[, <span class='no'>disGroup</span> <span class='kw'>:=</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/Round'>round</a></span>(<span class='no'>distance</span> / <span class='fl'>100</span>) * <span class='fl'>100</span>]
       <span class='no'>freqs</span> <span class='kw'>&lt;-</span> <span class='no'>out</span>[, <span class='no'>.N</span>, <span class='kw'>by</span> <span class='kw'>=</span> <span class='st'>"disGroup"</span>]
       <span class='no'>freqs</span>[, <span class='fu'>`:=`</span>(<span class='kw'>cumSum</span> <span class='kw'>=</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/cumsum'>cumsum</a></span>(<span class='no'>N</span>), <span class='kw'>N</span> <span class='kw'>=</span> <span class='no'>N</span>)]
       <span class='fu'><a href='http://quickplot.predictiveecology.org//reference/Plot.html'>Plot</a></span>(<span class='no'>freqs</span>$<span class='no'>disGroup</span>, <span class='no'>freqs</span>$<span class='no'>cumSum</span>, <span class='kw'>addTo</span> <span class='kw'>=</span> <span class='st'>"CumulativeNumberSettled"</span>,
            <span class='kw'>title</span> <span class='kw'>=</span> <span class='st'>"Cumulative Number Settled"</span>) <span class='co'># can plot the distance X number</span>
       <span class='fu'><a href='https://www.rdocumentation.org/packages/graphics/topics/abline'>abline</a></span>(<span class='kw'>v</span> <span class='kw'>=</span> <span class='no'>meanAdvectionMag</span> + <span class='no'>meanDist</span>)
       <span class='no'>newTitle</span> <span class='kw'>&lt;-</span> <span class='st'>"Number Settled By Distance"</span>
       <span class='fu'><a href='http://quickplot.predictiveecology.org//reference/Plot.html'>Plot</a></span>(<span class='no'>freqs</span>$<span class='no'>disGroup</span>, <span class='no'>freqs</span>$<span class='no'>N</span>, <span class='kw'>addTo</span> <span class='kw'>=</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/grep'>gsub</a></span>(<span class='st'>" "</span>, <span class='st'>""</span>, <span class='no'>newTitle</span>),
            <span class='kw'>title</span> <span class='kw'>=</span> <span class='no'>newTitle</span>) <span class='co'># can plot the distance X number</span>
       <span class='fu'><a href='https://www.rdocumentation.org/packages/graphics/topics/abline'>abline</a></span>(<span class='kw'>v</span> <span class='kw'>=</span> <span class='no'>meanAdvectionMag</span> + <span class='no'>meanDist</span>)
       <span class='co'># should be 0.63:</span>
       <span class='no'>freqs</span>[<span class='no'>disGroup</span> <span class='kw'>==</span> <span class='no'>meanAdvectionMag</span> + <span class='no'>meanDist</span>, <span class='no'>cumSum</span>] / <span class='fu'><a href='https://www.rdocumentation.org/packages/raster/topics/headtail'>tail</a></span>(<span class='no'>freqs</span>,<span class='fl'>1</span>)[, <span class='no'>cumSum</span>]
       <span class='fu'><a href='https://www.rdocumentation.org/packages/graphics/topics/mtext'>mtext</a></span>(<span class='kw'>side</span> <span class='kw'>=</span> <span class='fl'>3</span>, <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/paste'>paste</a></span>(<span class='st'>"Average habitat quality: "</span>, <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/Round'>round</a></span>(<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/mean'>mean</a></span>(<span class='no'>rasQuality</span>[], <span class='kw'>na.rm</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>), <span class='fl'>2</span>)),
             <span class='kw'>outer</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>, <span class='kw'>line</span> <span class='kw'>=</span> -<span class='fl'>2</span>, <span class='kw'>cex</span> <span class='kw'>=</span> <span class='fl'>2</span>)
    }
    <span class='fu'><a href='http://quickplot.predictiveecology.org//reference/dev.html'>dev</a></span>() <span class='co'># don't use Rstudio windows, which is very slow</span>
    <span class='fu'><a href='http://quickplot.predictiveecology.org//reference/clearPlot.html'>clearPlot</a></span>()
    <span class='no'>out</span> <span class='kw'>&lt;-</span> <span class='fu'>spread3</span>(<span class='kw'>rasAbundance</span> <span class='kw'>=</span> <span class='no'>rasAbundance</span>,
                   <span class='kw'>rasQuality</span> <span class='kw'>=</span> <span class='no'>rasQuality</span>,
                   <span class='kw'>advectionDir</span> <span class='kw'>=</span> <span class='no'>advectionDir</span>,
                   <span class='kw'>advectionMag</span> <span class='kw'>=</span> <span class='no'>advectionMag</span>,
                   <span class='kw'>meanDist</span> <span class='kw'>=</span> <span class='no'>meanDist</span>, <span class='kw'>verbose</span> <span class='kw'>=</span> <span class='fl'>2</span>,
                   <span class='kw'>plot.it</span> <span class='kw'>=</span> <span class='fl'>2</span>)

    <span class='fu'>plotDispersalKernel</span>(<span class='no'>out</span>, <span class='no'>advectionMag</span>)
  }

  <span class='co'>#########################################################</span>
  <span class='co'>### The case of variable quality raster</span>
  <span class='co'>#########################################################</span>
  <span class='kw'>if</span> (<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/library'>require</a></span>(<span class='no'>sf</span>) <span class='kw'>&amp;&amp;</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/library'>require</a></span>(<span class='no'>fasterize</span>)) {
    <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/library'>library</a></span>(<span class='no'>SpaDES.tools</span>) <span class='co'># for gaussMap</span>
    <span class='no'>a</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='randomStudyArea.html'>randomStudyArea</a></span>(<span class='kw'>size</span> <span class='kw'>=</span> <span class='fl'>1e9</span>)
    <span class='no'>ras</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/raster/topics/raster'>raster</a></span>(<span class='fu'><a href='https://www.rdocumentation.org/packages/raster/topics/extent'>extent</a></span>(<span class='no'>a</span>), <span class='kw'>res</span> <span class='kw'>=</span> <span class='fl'>100</span>)
    <span class='no'>mask</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/fasterize/topics/fasterize'>fasterize</a></span>(<span class='fu'><a href='https://www.rdocumentation.org/packages/sf/topics/st_as_sf'>st_as_sf</a></span>(<span class='no'>a</span>), <span class='no'>ras</span>) <span class='co'># faster than raster::rasterize</span>
    <span class='no'>rasQuality</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='gaussmap.html'>gaussMap</a></span>(<span class='no'>ras</span>)
    <span class='fu'><a href='https://www.rdocumentation.org/packages/raster/topics/projection'>crs</a></span>(<span class='no'>rasQuality</span>) <span class='kw'>&lt;-</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/raster/topics/projection'>crs</a></span>(<span class='no'>a</span>)
    <span class='no'>rasQuality</span>[<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/NA'>is.na</a></span>(<span class='no'>mask</span>)] <span class='kw'>&lt;-</span> <span class='fl'>NA</span>
    <span class='co'># rescale so min is 0.75 and max is 1</span>
    <span class='no'>rasQuality</span>[] <span class='kw'>&lt;-</span> <span class='no'>rasQuality</span>[] / (<span class='fu'><a href='https://www.rdocumentation.org/packages/raster/topics/extremeValues'>maxValue</a></span>(<span class='no'>rasQuality</span>) * <span class='fl'>4</span> ) + <span class='fl'>1</span>/<span class='fl'>4</span>
    <span class='no'>rasAbundance</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/raster/topics/raster'>raster</a></span>(<span class='no'>rasQuality</span>)
    <span class='no'>rasAbundance</span>[] <span class='kw'>&lt;-</span> <span class='fl'>0</span>
    <span class='no'>startPixel</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/sample'>sample</a></span>(<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/seq'>seq</a></span>(<span class='fu'><a href='https://www.rdocumentation.org/packages/raster/topics/ncell'>ncell</a></span>(<span class='no'>rasAbundance</span>)), <span class='fl'>300</span>)
    <span class='no'>rasAbundance</span>[<span class='no'>startPixel</span>] <span class='kw'>&lt;-</span> <span class='fl'>1000</span>
    <span class='no'>advectionDir</span> <span class='kw'>&lt;-</span> <span class='fl'>75</span>
    <span class='no'>advectionMag</span> <span class='kw'>&lt;-</span> <span class='fl'>4</span> * <span class='fu'><a href='https://www.rdocumentation.org/packages/raster/topics/resolution'>res</a></span>(<span class='no'>rasAbundance</span>)[<span class='fl'>1</span>]
    <span class='no'>meanDist</span> <span class='kw'>&lt;-</span> <span class='fl'>2600</span>
    <span class='fu'><a href='http://quickplot.predictiveecology.org//reference/clearPlot.html'>clearPlot</a></span>()
    <span class='no'>out</span> <span class='kw'>&lt;-</span> <span class='fu'>spread3</span>(<span class='kw'>rasAbundance</span> <span class='kw'>=</span> <span class='no'>rasAbundance</span>,
                   <span class='kw'>rasQuality</span> <span class='kw'>=</span> <span class='no'>rasQuality</span>,
                   <span class='kw'>advectionDir</span> <span class='kw'>=</span> <span class='no'>advectionDir</span>,
                   <span class='kw'>advectionMag</span> <span class='kw'>=</span> <span class='no'>advectionMag</span>,
                   <span class='kw'>meanDist</span> <span class='kw'>=</span> <span class='no'>meanDist</span>, <span class='kw'>verbose</span> <span class='kw'>=</span> <span class='fl'>2</span>,
                   <span class='kw'>plot.it</span> <span class='kw'>=</span> <span class='fl'>1</span>)
    <span class='kw'>if</span> (<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/interactive'>interactive</a></span>()) {
      <span class='fu'>plotDispersalKernel</span>(<span class='no'>out</span>, <span class='no'>advectionMag</span>)
    }
  }</div><div class='output co'>#&gt; <span class='message'>Loading required package: sf</span></div><div class='output co'>#&gt; <span class='message'>Linking to GEOS 3.6.2, GDAL 2.2.3, PROJ 4.9.3</span></div><div class='output co'>#&gt; <span class='message'>Loading required package: fasterize</span></div><div class='output co'>#&gt; <span class='message'></span>
#&gt; <span class='message'>Attaching package: ‘fasterize’</span></div><div class='output co'>#&gt; <span class='message'>The following object is masked from ‘package:graphics’:</span>
#&gt; <span class='message'></span>
#&gt; <span class='message'>    plot</span></div><div class='output co'>#&gt; <span class='message'>assuming that advectionDir is in geographic degrees(i.e., North is 0)</span></div><div class='output co'>#&gt; <span class='message'>Iteration 1</span></div><div class='output co'>#&gt; <span class='message'>Number still dispersing 218467.728350372</span></div><div class='output co'>#&gt; <span class='message'>Iteration 2</span></div><div class='output co'>#&gt; <span class='message'>Number still dispersing 217052.287599841</span></div><div class='output co'>#&gt; <span class='message'>Iteration 3</span></div><div class='output co'>#&gt; <span class='message'>Number still dispersing 214647.985352566</span></div><div class='output co'>#&gt; <span class='message'>Iteration 4</span></div><div class='output co'>#&gt; <span class='message'>Number still dispersing 211746.07336431</span></div><div class='output co'>#&gt; <span class='message'>Iteration 5</span></div><div class='output co'>#&gt; <span class='message'>Number still dispersing 209719.917583577</span></div><div class='output co'>#&gt; <span class='message'>Iteration 6</span></div><div class='output co'>#&gt; <span class='message'>Number still dispersing 207642.985655808</span></div><div class='output co'>#&gt; <span class='message'>Iteration 7</span></div><div class='output co'>#&gt; <span class='message'>Number still dispersing 204966.911057916</span></div><div class='output co'>#&gt; <span class='message'>Iteration 8</span></div><div class='output co'>#&gt; <span class='message'>Number still dispersing 203004.512786741</span></div><div class='output co'>#&gt; <span class='message'>Iteration 9</span></div><div class='output co'>#&gt; <span class='message'>Number still dispersing 200250.304543639</span></div><div class='output co'>#&gt; <span class='message'>Iteration 10</span></div><div class='output co'>#&gt; <span class='message'>Number still dispersing 197115.718376177</span></div><div class='output co'>#&gt; <span class='message'>Iteration 11</span></div><div class='output co'>#&gt; <span class='message'>Number still dispersing 193420.174278494</span></div><div class='output co'>#&gt; <span class='message'>Iteration 12</span></div><div class='output co'>#&gt; <span class='message'>Number still dispersing 189776.407211978</span></div><div class='output co'>#&gt; <span class='message'>Iteration 13</span></div><div class='output co'>#&gt; <span class='message'>Number still dispersing 186317.046739708</span></div><div class='output co'>#&gt; <span class='message'>Iteration 14</span></div><div class='output co'>#&gt; <span class='message'>Number still dispersing 183314.969329682</span></div><div class='output co'>#&gt; <span class='message'>Iteration 15</span></div><div class='output co'>#&gt; <span class='message'>Number still dispersing 180379.385112295</span></div><div class='output co'>#&gt; <span class='message'>Iteration 16</span></div><div class='output co'>#&gt; <span class='message'>Number still dispersing 177424.318374344</span></div><div class='output co'>#&gt; <span class='message'>Iteration 17</span></div><div class='output co'>#&gt; <span class='message'>Number still dispersing 174666.142014468</span></div><div class='output co'>#&gt; <span class='message'>Iteration 18</span></div><div class='output co'>#&gt; <span class='message'>Number still dispersing 171098.646840265</span></div><div class='output co'>#&gt; <span class='message'>Iteration 19</span></div><div class='output co'>#&gt; <span class='message'>Number still dispersing 167664.456651507</span></div><div class='output co'>#&gt; <span class='message'>Iteration 20</span></div><div class='output co'>#&gt; <span class='message'>Number still dispersing 164193.181754325</span></div><div class='output co'>#&gt; <span class='message'>Iteration 21</span></div><div class='output co'>#&gt; <span class='message'>Number still dispersing 161224.053369048</span></div><div class='output co'>#&gt; <span class='message'>Iteration 22</span></div><div class='output co'>#&gt; <span class='message'>Number still dispersing 157194.37762001</span></div><div class='output co'>#&gt; <span class='message'>Iteration 23</span></div><div class='output co'>#&gt; <span class='message'>Number still dispersing 153638.720896824</span></div><div class='output co'>#&gt; <span class='message'>Iteration 24</span></div><div class='output co'>#&gt; <span class='message'>Number still dispersing 149802.892949567</span></div><div class='output co'>#&gt; <span class='message'>Iteration 25</span></div><div class='output co'>#&gt; <span class='message'>Number still dispersing 146058.330199062</span></div><div class='output co'>#&gt; <span class='message'>Iteration 26</span></div><div class='output co'>#&gt; <span class='message'>Number still dispersing 142238.251942236</span></div><div class='output co'>#&gt; <span class='message'>Iteration 27</span></div><div class='output co'>#&gt; <span class='message'>Number still dispersing 139095.166881333</span></div><div class='output co'>#&gt; <span class='message'>Iteration 28</span></div><div class='output co'>#&gt; <span class='message'>Number still dispersing 135765.613716786</span></div><div class='output co'>#&gt; <span class='message'>Iteration 29</span></div><div class='output co'>#&gt; <span class='message'>Number still dispersing 131981.89735103</span></div><div class='output co'>#&gt; <span class='message'>Iteration 30</span></div><div class='output co'>#&gt; <span class='message'>Number still dispersing 128157.703989407</span></div><div class='output co'>#&gt; <span class='message'>Iteration 31</span></div><div class='output co'>#&gt; <span class='message'>Number still dispersing 124626.625676</span></div><div class='output co'>#&gt; <span class='message'>Iteration 32</span></div><div class='output co'>#&gt; <span class='message'>Number still dispersing 120454.202687023</span></div><div class='output co'>#&gt; <span class='message'>Iteration 33</span></div><div class='output co'>#&gt; <span class='message'>Number still dispersing 116667.229657478</span></div><div class='output co'>#&gt; <span class='message'>Iteration 34</span></div><div class='output co'>#&gt; <span class='message'>Number still dispersing 112462.841233291</span></div><div class='output co'>#&gt; <span class='message'>Iteration 35</span></div><div class='output co'>#&gt; <span class='message'>Number still dispersing 108224.772042226</span></div><div class='output co'>#&gt; <span class='message'>Iteration 36</span></div><div class='output co'>#&gt; <span class='message'>Number still dispersing 104658.269710226</span></div><div class='output co'>#&gt; <span class='message'>Iteration 37</span></div><div class='output co'>#&gt; <span class='message'>Number still dispersing 100738.193149239</span></div><div class='output co'>#&gt; <span class='message'>Iteration 38</span></div><div class='output co'>#&gt; <span class='message'>Number still dispersing 97379.7306585565</span></div><div class='output co'>#&gt; <span class='message'>Iteration 39</span></div><div class='output co'>#&gt; <span class='message'>Number still dispersing 93427.6810269982</span></div><div class='output co'>#&gt; <span class='message'>Iteration 40</span></div><div class='output co'>#&gt; <span class='message'>Number still dispersing 90442.7614934307</span></div><div class='output co'>#&gt; <span class='message'>Iteration 41</span></div><div class='output co'>#&gt; <span class='message'>Number still dispersing 87629.3054934393</span></div><div class='output co'>#&gt; <span class='message'>Iteration 42</span></div><div class='output co'>#&gt; <span class='message'>Number still dispersing 83998.1402508009</span></div><div class='output co'>#&gt; <span class='message'>Iteration 43</span></div><div class='output co'>#&gt; <span class='message'>Number still dispersing 80291.6109629692</span></div><div class='output co'>#&gt; <span class='message'>Iteration 44</span></div><div class='output co'>#&gt; <span class='message'>Number still dispersing 76939.9246709389</span></div><div class='output co'>#&gt; <span class='message'>Iteration 45</span></div><div class='output co'>#&gt; <span class='message'>Number still dispersing 73570.0029625303</span></div><div class='output co'>#&gt; <span class='message'>Iteration 46</span></div><div class='output co'>#&gt; <span class='message'>Number still dispersing 70570.6246272812</span></div><div class='output co'>#&gt; <span class='message'>Iteration 47</span></div><div class='output co'>#&gt; <span class='message'>Number still dispersing 66850.0452826847</span></div><div class='output co'>#&gt; <span class='message'>Iteration 48</span></div><div class='output co'>#&gt; <span class='message'>Number still dispersing 64081.1317406593</span></div><div class='output co'>#&gt; <span class='message'>Iteration 49</span></div><div class='output co'>#&gt; <span class='message'>Number still dispersing 60926.2940162978</span></div><div class='output co'>#&gt; <span class='message'>Iteration 50</span></div><div class='output co'>#&gt; <span class='message'>Number still dispersing 58413.9276578111</span></div><div class='output co'>#&gt; <span class='message'>Iteration 51</span></div><div class='output co'>#&gt; <span class='message'>Number still dispersing 55929.2494261002</span></div><div class='output co'>#&gt; <span class='message'>Iteration 52</span></div><div class='output co'>#&gt; <span class='message'>Number still dispersing 53053.9452422261</span></div><div class='output co'>#&gt; <span class='message'>Iteration 53</span></div><div class='output co'>#&gt; <span class='message'>Number still dispersing 50495.9962559369</span></div><div class='output co'>#&gt; <span class='message'>Iteration 54</span></div><div class='output co'>#&gt; <span class='message'>Number still dispersing 47132.8167978062</span></div><div class='output co'>#&gt; <span class='message'>Iteration 55</span></div><div class='output co'>#&gt; <span class='message'>Number still dispersing 44453.4488577386</span></div><div class='output co'>#&gt; <span class='message'>Iteration 56</span></div><div class='output co'>#&gt; <span class='message'>Number still dispersing 41846.2111409061</span></div><div class='output co'>#&gt; <span class='message'>Iteration 57</span></div><div class='output co'>#&gt; <span class='message'>Number still dispersing 39377.1733107536</span></div><div class='output co'>#&gt; <span class='message'>Iteration 58</span></div><div class='output co'>#&gt; <span class='message'>Number still dispersing 36874.8592082388</span></div><div class='output co'>#&gt; <span class='message'>Iteration 59</span></div><div class='output co'>#&gt; <span class='message'>Number still dispersing 34660.9514943397</span></div><div class='output co'>#&gt; <span class='message'>Iteration 60</span></div><div class='output co'>#&gt; <span class='message'>Number still dispersing 32316.6212929074</span></div><div class='output co'>#&gt; <span class='message'>Iteration 61</span></div><div class='output co'>#&gt; <span class='message'>Number still dispersing 30464.1994159539</span></div><div class='output co'>#&gt; <span class='message'>Iteration 62</span></div><div class='output co'>#&gt; <span class='message'>Number still dispersing 28091.8088630063</span></div><div class='output co'>#&gt; <span class='message'>Iteration 63</span></div><div class='output co'>#&gt; <span class='message'>Number still dispersing 26206.0469375026</span></div><div class='output co'>#&gt; <span class='message'>Iteration 64</span></div><div class='output co'>#&gt; <span class='message'>Number still dispersing 24169.1822807364</span></div><div class='output co'>#&gt; <span class='message'>Iteration 65</span></div><div class='output co'>#&gt; <span class='message'>Number still dispersing 22445.232356585</span></div><div class='output co'>#&gt; <span class='message'>Iteration 66</span></div><div class='output co'>#&gt; <span class='message'>Number still dispersing 21134.6840389676</span></div><div class='output co'>#&gt; <span class='message'>Iteration 67</span></div><div class='output co'>#&gt; <span class='message'>Number still dispersing 19448.560312541</span></div><div class='output co'>#&gt; <span class='message'>Iteration 68</span></div><div class='output co'>#&gt; <span class='message'>Number still dispersing 17715.8549636831</span></div><div class='output co'>#&gt; <span class='message'>Iteration 69</span></div><div class='output co'>#&gt; <span class='message'>Number still dispersing 15916.4776553081</span></div><div class='output co'>#&gt; <span class='message'>Iteration 70</span></div><div class='output co'>#&gt; <span class='message'>Number still dispersing 14560.9174690095</span></div><div class='output co'>#&gt; <span class='message'>Iteration 71</span></div><div class='output co'>#&gt; <span class='message'>Number still dispersing 13255.7118264949</span></div><div class='output co'>#&gt; <span class='message'>Iteration 72</span></div><div class='output co'>#&gt; <span class='message'>Number still dispersing 11535.3379619362</span></div><div class='output co'>#&gt; <span class='message'>Iteration 73</span></div><div class='output co'>#&gt; <span class='message'>Number still dispersing 10092.6649979768</span></div><div class='output co'>#&gt; <span class='message'>Iteration 74</span></div><div class='output co'>#&gt; <span class='message'>Number still dispersing 8971.92117765205</span></div><div class='output co'>#&gt; <span class='message'>Iteration 75</span></div><div class='output co'>#&gt; <span class='message'>Number still dispersing 8047.72642271128</span></div><div class='output co'>#&gt; <span class='message'>Iteration 76</span></div><div class='output co'>#&gt; <span class='message'>Number still dispersing 7455.71993251491</span></div><div class='output co'>#&gt; <span class='message'>Iteration 77</span></div><div class='output co'>#&gt; <span class='message'>Number still dispersing 6321.7851880863</span></div><div class='output co'>#&gt; <span class='message'>Iteration 78</span></div><div class='output co'>#&gt; <span class='message'>Number still dispersing 5711.40088272174</span></div><div class='output co'>#&gt; <span class='message'>Iteration 79</span></div><div class='output co'>#&gt; <span class='message'>Number still dispersing 5241.69485451169</span></div><div class='output co'>#&gt; <span class='message'>Iteration 80</span></div><div class='output co'>#&gt; <span class='message'>Number still dispersing 4214.80412479087</span></div><div class='output co'>#&gt; <span class='message'>Iteration 81</span></div><div class='output co'>#&gt; <span class='message'>Number still dispersing 3341.24918249259</span></div><div class='output co'>#&gt; <span class='message'>Iteration 82</span></div><div class='output co'>#&gt; <span class='message'>Number still dispersing 2721.61175553491</span></div><div class='output co'>#&gt; <span class='message'>Iteration 83</span></div><div class='output co'>#&gt; <span class='message'>Number still dispersing 2477.52214486491</span></div><div class='output co'>#&gt; <span class='message'>Iteration 84</span></div><div class='output co'>#&gt; <span class='message'>Number still dispersing 1505.84256424761</span></div><div class='output co'>#&gt; <span class='message'>Iteration 85</span></div><div class='output co'>#&gt; <span class='message'>Number still dispersing 44.3836898388998</span></div><div class='input'>
  <span class='co'>###############################################################################</span>
  <span class='co'>### The case of variable quality raster, raster for advectionDir &amp; advectionMag</span>
  <span class='co'>###############################################################################</span>
  <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/library'>library</a></span>(<span class='no'>raster</span>)
  <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/library'>library</a></span>(<span class='no'>quickPlot</span>)
  <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/library'>library</a></span>(<span class='no'>SpaDES.tools</span>)
  <span class='no'>maxDim</span> <span class='kw'>&lt;-</span> <span class='fl'>10000</span>
  <span class='no'>ras</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/raster/topics/raster'>raster</a></span>(<span class='fu'><a href='https://www.rdocumentation.org/packages/raster/topics/extent'>extent</a></span>(<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/c'>c</a></span>(<span class='fl'>0</span>, <span class='no'>maxDim</span>, <span class='fl'>0</span>, <span class='no'>maxDim</span>)), <span class='kw'>res</span> <span class='kw'>=</span> <span class='fl'>100</span>, <span class='kw'>vals</span> <span class='kw'>=</span> <span class='fl'>0</span>)
  <span class='no'>rasQuality</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/raster/topics/raster'>raster</a></span>(<span class='no'>ras</span>)
  <span class='no'>rasQuality</span>[] <span class='kw'>&lt;-</span> <span class='fl'>1</span>
  <span class='no'>rasAbundance</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/raster/topics/raster'>raster</a></span>(<span class='no'>rasQuality</span>)
  <span class='no'>rasAbundance</span>[] <span class='kw'>&lt;-</span> <span class='fl'>NA</span>
  <span class='co'># startPixel &lt;- middlePixel(rasAbundance)</span>
  <span class='no'>startPixel</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/sample'>sample</a></span>(<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/seq'>seq</a></span>(<span class='fu'><a href='https://www.rdocumentation.org/packages/raster/topics/ncell'>ncell</a></span>(<span class='no'>rasAbundance</span>)), <span class='fl'>25</span>)
  <span class='no'>rasAbundance</span>[<span class='no'>startPixel</span>] <span class='kw'>&lt;-</span> <span class='fl'>1000</span>

  <span class='co'># raster for advectionDir</span>
  <span class='no'>advectionDir</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='gaussmap.html'>gaussMap</a></span>(<span class='no'>ras</span>)
  <span class='fu'><a href='https://www.rdocumentation.org/packages/raster/topics/projection'>crs</a></span>(<span class='no'>advectionDir</span>) <span class='kw'>&lt;-</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/raster/topics/projection'>crs</a></span>(<span class='no'>rasQuality</span>)
  <span class='co'># rescale so min is 0.75 and max is 1</span>
  <span class='no'>advectionDir</span>[] <span class='kw'>&lt;-</span> <span class='no'>advectionDir</span>[] / (<span class='fu'><a href='https://www.rdocumentation.org/packages/raster/topics/extremeValues'>maxValue</a></span>(<span class='no'>advectionDir</span>)) * <span class='fl'>180</span>

  <span class='co'># raster for advectionMag</span>
  <span class='no'>advectionMag</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='gaussmap.html'>gaussMap</a></span>(<span class='no'>ras</span>)
  <span class='fu'><a href='https://www.rdocumentation.org/packages/raster/topics/projection'>crs</a></span>(<span class='no'>advectionMag</span>) <span class='kw'>&lt;-</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/raster/topics/projection'>crs</a></span>(<span class='no'>rasQuality</span>)
  <span class='co'># rescale so min is 0.75 and max is 1</span>
  <span class='no'>advectionMag</span>[] <span class='kw'>&lt;-</span> <span class='no'>advectionMag</span>[] / (<span class='fu'><a href='https://www.rdocumentation.org/packages/raster/topics/extremeValues'>maxValue</a></span>(<span class='no'>advectionMag</span>)) * <span class='fl'>600</span>

  <span class='no'>out</span> <span class='kw'>&lt;-</span> <span class='fu'>spread3</span>(<span class='kw'>rasAbundance</span> <span class='kw'>=</span> <span class='no'>rasAbundance</span>,
                 <span class='kw'>rasQuality</span> <span class='kw'>=</span> <span class='no'>rasQuality</span>,
                 <span class='kw'>advectionDir</span> <span class='kw'>=</span> <span class='no'>advectionDir</span>,
                 <span class='kw'>advectionMag</span> <span class='kw'>=</span> <span class='no'>advectionMag</span>,
                 <span class='kw'>meanDist</span> <span class='kw'>=</span> <span class='no'>meanDist</span>, <span class='kw'>verbose</span> <span class='kw'>=</span> <span class='fl'>2</span>,
                 <span class='kw'>plot.it</span> <span class='kw'>=</span> <span class='fl'>1</span>)</div><div class='output co'>#&gt; <span class='message'>assuming that advectionDir is in geographic degrees(i.e., North is 0)</span></div><div class='output co'>#&gt; <span class='message'>Iteration 1</span></div><div class='output co'>#&gt; <span class='message'>Number still dispersing 24951.7427882092</span></div><div class='output co'>#&gt; <span class='message'>Iteration 2</span></div><div class='output co'>#&gt; <span class='message'>Number still dispersing 24870.0592892225</span></div><div class='output co'>#&gt; <span class='message'>Iteration 3</span></div><div class='output co'>#&gt; <span class='message'>Number still dispersing 24735.2901165846</span></div><div class='output co'>#&gt; <span class='message'>Iteration 4</span></div><div class='output co'>#&gt; <span class='message'>Number still dispersing 24379.2168253953</span></div><div class='output co'>#&gt; <span class='message'>Iteration 5</span></div><div class='output co'>#&gt; <span class='message'>Number still dispersing 23775.9626226885</span></div><div class='output co'>#&gt; <span class='message'>Iteration 6</span></div><div class='output co'>#&gt; <span class='message'>Number still dispersing 23449.4662882185</span></div><div class='output co'>#&gt; <span class='message'>Iteration 7</span></div><div class='output co'>#&gt; <span class='message'>Number still dispersing 23145.3231817019</span></div><div class='output co'>#&gt; <span class='message'>Iteration 8</span></div><div class='output co'>#&gt; <span class='message'>Number still dispersing 22786.4827643283</span></div><div class='output co'>#&gt; <span class='message'>Iteration 9</span></div><div class='output co'>#&gt; <span class='message'>Number still dispersing 22380.7192873888</span></div><div class='output co'>#&gt; <span class='message'>Iteration 10</span></div><div class='output co'>#&gt; <span class='message'>Number still dispersing 21918.7232245054</span></div><div class='output co'>#&gt; <span class='message'>Iteration 11</span></div><div class='output co'>#&gt; <span class='message'>Number still dispersing 21444.2185104944</span></div><div class='output co'>#&gt; <span class='message'>Iteration 12</span></div><div class='output co'>#&gt; <span class='message'>Number still dispersing 20958.7930770182</span></div><div class='output co'>#&gt; <span class='message'>Iteration 13</span></div><div class='output co'>#&gt; <span class='message'>Number still dispersing 20417.7880405449</span></div><div class='output co'>#&gt; <span class='message'>Iteration 14</span></div><div class='output co'>#&gt; <span class='message'>Number still dispersing 19794.4378570753</span></div><div class='output co'>#&gt; <span class='message'>Iteration 15</span></div><div class='output co'>#&gt; <span class='message'>Number still dispersing 19197.9295114491</span></div><div class='output co'>#&gt; <span class='message'>Iteration 16</span></div><div class='output co'>#&gt; <span class='message'>Number still dispersing 18614.4961230115</span></div><div class='output co'>#&gt; <span class='message'>Iteration 17</span></div><div class='output co'>#&gt; <span class='message'>Number still dispersing 17989.9727064152</span></div><div class='output co'>#&gt; <span class='message'>Iteration 18</span></div><div class='output co'>#&gt; <span class='message'>Number still dispersing 17312.9851545405</span></div><div class='output co'>#&gt; <span class='message'>Iteration 19</span></div><div class='output co'>#&gt; <span class='message'>Number still dispersing 16640.8898334055</span></div><div class='output co'>#&gt; <span class='message'>Iteration 20</span></div><div class='output co'>#&gt; <span class='message'>Number still dispersing 16011.5099584516</span></div><div class='output co'>#&gt; <span class='message'>Iteration 21</span></div><div class='output co'>#&gt; <span class='message'>Number still dispersing 15389.3205122649</span></div><div class='output co'>#&gt; <span class='message'>Iteration 22</span></div><div class='output co'>#&gt; <span class='message'>Number still dispersing 14716.7330432009</span></div><div class='output co'>#&gt; <span class='message'>Iteration 23</span></div><div class='output co'>#&gt; <span class='message'>Number still dispersing 14092.2642130129</span></div><div class='output co'>#&gt; <span class='message'>Iteration 24</span></div><div class='output co'>#&gt; <span class='message'>Number still dispersing 13432.2816408026</span></div><div class='output co'>#&gt; <span class='message'>Iteration 25</span></div><div class='output co'>#&gt; <span class='message'>Number still dispersing 12795.0155873564</span></div><div class='output co'>#&gt; <span class='message'>Iteration 26</span></div><div class='output co'>#&gt; <span class='message'>Number still dispersing 12162.7012564564</span></div><div class='output co'>#&gt; <span class='message'>Iteration 27</span></div><div class='output co'>#&gt; <span class='message'>Number still dispersing 11551.251499279</span></div><div class='output co'>#&gt; <span class='message'>Iteration 28</span></div><div class='output co'>#&gt; <span class='message'>Number still dispersing 10952.0429879568</span></div><div class='output co'>#&gt; <span class='message'>Iteration 29</span></div><div class='output co'>#&gt; <span class='message'>Number still dispersing 10337.9391505125</span></div><div class='output co'>#&gt; <span class='message'>Iteration 30</span></div><div class='output co'>#&gt; <span class='message'>Number still dispersing 9764.88577808051</span></div><div class='output co'>#&gt; <span class='message'>Iteration 31</span></div><div class='output co'>#&gt; <span class='message'>Number still dispersing 9208.77724625343</span></div><div class='output co'>#&gt; <span class='message'>Iteration 32</span></div><div class='output co'>#&gt; <span class='message'>Number still dispersing 8651.84152402983</span></div><div class='output co'>#&gt; <span class='message'>Iteration 33</span></div><div class='output co'>#&gt; <span class='message'>Number still dispersing 8116.10154585853</span></div><div class='output co'>#&gt; <span class='message'>Iteration 34</span></div><div class='output co'>#&gt; <span class='message'>Number still dispersing 7593.03780155211</span></div><div class='output co'>#&gt; <span class='message'>Iteration 35</span></div><div class='output co'>#&gt; <span class='message'>Number still dispersing 7098.21054516305</span></div><div class='output co'>#&gt; <span class='message'>Iteration 36</span></div><div class='output co'>#&gt; <span class='message'>Number still dispersing 6626.15202287482</span></div><div class='output co'>#&gt; <span class='message'>Iteration 37</span></div><div class='output co'>#&gt; <span class='message'>Number still dispersing 6160.80239981882</span></div><div class='output co'>#&gt; <span class='message'>Iteration 38</span></div><div class='output co'>#&gt; <span class='message'>Number still dispersing 5721.19324986207</span></div><div class='output co'>#&gt; <span class='message'>Iteration 39</span></div><div class='output co'>#&gt; <span class='message'>Number still dispersing 5292.46228228828</span></div><div class='output co'>#&gt; <span class='message'>Iteration 40</span></div><div class='output co'>#&gt; <span class='message'>Number still dispersing 4896.76300051138</span></div><div class='output co'>#&gt; <span class='message'>Iteration 41</span></div><div class='output co'>#&gt; <span class='message'>Number still dispersing 4522.3623428805</span></div><div class='output co'>#&gt; <span class='message'>Iteration 42</span></div><div class='output co'>#&gt; <span class='message'>Number still dispersing 4159.27200905089</span></div><div class='output co'>#&gt; <span class='message'>Iteration 43</span></div><div class='output co'>#&gt; <span class='message'>Number still dispersing 3825.02769794956</span></div><div class='output co'>#&gt; <span class='message'>Iteration 44</span></div><div class='output co'>#&gt; <span class='message'>Number still dispersing 3504.01100696495</span></div><div class='output co'>#&gt; <span class='message'>Iteration 45</span></div><div class='output co'>#&gt; <span class='message'>Number still dispersing 3204.80955149448</span></div><div class='output co'>#&gt; <span class='message'>Iteration 46</span></div><div class='output co'>#&gt; <span class='message'>Number still dispersing 2922.41541536829</span></div><div class='output co'>#&gt; <span class='message'>Iteration 47</span></div><div class='output co'>#&gt; <span class='message'>Number still dispersing 2641.41071183887</span></div><div class='output co'>#&gt; <span class='message'>Iteration 48</span></div><div class='output co'>#&gt; <span class='message'>Number still dispersing 2392.98482631118</span></div><div class='output co'>#&gt; <span class='message'>Iteration 49</span></div><div class='output co'>#&gt; <span class='message'>Number still dispersing 2152.93973787239</span></div><div class='output co'>#&gt; <span class='message'>Iteration 50</span></div><div class='output co'>#&gt; <span class='message'>Number still dispersing 1929.37092674112</span></div><div class='output co'>#&gt; <span class='message'>Iteration 51</span></div><div class='output co'>#&gt; <span class='message'>Number still dispersing 1735.16507877662</span></div><div class='output co'>#&gt; <span class='message'>Iteration 52</span></div><div class='output co'>#&gt; <span class='message'>Number still dispersing 1556.594528115</span></div><div class='output co'>#&gt; <span class='message'>Iteration 53</span></div><div class='output co'>#&gt; <span class='message'>Number still dispersing 1392.21104477694</span></div><div class='output co'>#&gt; <span class='message'>Iteration 54</span></div><div class='output co'>#&gt; <span class='message'>Number still dispersing 1235.23863261621</span></div><div class='output co'>#&gt; <span class='message'>Iteration 55</span></div><div class='output co'>#&gt; <span class='message'>Number still dispersing 1088.65079044678</span></div><div class='output co'>#&gt; <span class='message'>Iteration 56</span></div><div class='output co'>#&gt; <span class='message'>Number still dispersing 954.38355272802</span></div><div class='output co'>#&gt; <span class='message'>Iteration 57</span></div><div class='output co'>#&gt; <span class='message'>Number still dispersing 845.183990026415</span></div><div class='output co'>#&gt; <span class='message'>Iteration 58</span></div><div class='output co'>#&gt; <span class='message'>Number still dispersing 741.43926547817</span></div><div class='output co'>#&gt; <span class='message'>Iteration 59</span></div><div class='output co'>#&gt; <span class='message'>Number still dispersing 652.035811256006</span></div><div class='output co'>#&gt; <span class='message'>Iteration 60</span></div><div class='output co'>#&gt; <span class='message'>Number still dispersing 567.471519172994</span></div><div class='output co'>#&gt; <span class='message'>Iteration 61</span></div><div class='output co'>#&gt; <span class='message'>Number still dispersing 495.641778597423</span></div><div class='output co'>#&gt; <span class='message'>Iteration 62</span></div><div class='output co'>#&gt; <span class='message'>Number still dispersing 430.641360455192</span></div><div class='output co'>#&gt; <span class='message'>Iteration 63</span></div><div class='output co'>#&gt; <span class='message'>Number still dispersing 374.895678032357</span></div><div class='output co'>#&gt; <span class='message'>Iteration 64</span></div><div class='output co'>#&gt; <span class='message'>Number still dispersing 319.694006577937</span></div><div class='output co'>#&gt; <span class='message'>Iteration 65</span></div><div class='output co'>#&gt; <span class='message'>Number still dispersing 268.519626575015</span></div><div class='output co'>#&gt; <span class='message'>Iteration 66</span></div><div class='output co'>#&gt; <span class='message'>Number still dispersing 216.955304209989</span></div><div class='output co'>#&gt; <span class='message'>Iteration 67</span></div><div class='output co'>#&gt; <span class='message'>Number still dispersing 170.405981460802</span></div><div class='output co'>#&gt; <span class='message'>Iteration 68</span></div><div class='output co'>#&gt; <span class='message'>Number still dispersing 132.501289549143</span></div><div class='output co'>#&gt; <span class='message'>Iteration 69</span></div><div class='output co'>#&gt; <span class='message'>Number still dispersing 101.555666681501</span></div><div class='output co'>#&gt; <span class='message'>Iteration 70</span></div><div class='output co'>#&gt; <span class='message'>Number still dispersing 76.8664574350437</span></div><div class='output co'>#&gt; <span class='message'>Iteration 71</span></div><div class='output co'>#&gt; <span class='message'>Number still dispersing 59.5411209954569</span></div><div class='output co'>#&gt; <span class='message'>Iteration 72</span></div><div class='output co'>#&gt; <span class='message'>Number still dispersing 43.0625433307432</span></div><div class='img'><img src='spread3-1.png' alt='' width='700' height='433' /></div><div class='input'>
  <span class='kw'>if</span> (<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/interactive'>interactive</a></span>()) {
    <span class='fu'><a href='http://quickplot.predictiveecology.org//reference/dev.html'>dev</a></span>() <span class='co'># don't use Rstudio windows, which is very slow</span>
    <span class='fu'><a href='http://quickplot.predictiveecology.org//reference/clearPlot.html'>clearPlot</a></span>()
    <span class='fu'><a href='http://quickplot.predictiveecology.org//reference/Plot.html'>Plot</a></span>(<span class='no'>advectionDir</span>, <span class='kw'>title</span> <span class='kw'>=</span> <span class='st'>"Wind direction"</span>, <span class='kw'>cols</span> <span class='kw'>=</span> <span class='st'>"Reds"</span>)
    <span class='fu'><a href='http://quickplot.predictiveecology.org//reference/Plot.html'>Plot</a></span>(<span class='no'>advectionMag</span>, <span class='kw'>title</span> <span class='kw'>=</span> <span class='st'>"Wind speed"</span>, <span class='kw'>cols</span> <span class='kw'>=</span> <span class='st'>"Blues"</span>)
    <span class='fu'>plotDispersalKernel</span>(<span class='no'>out</span>, <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/mean'>mean</a></span>(<span class='no'>advectionMag</span>[]))
    <span class='fu'><a href='http://quickplot.predictiveecology.org//reference/Plot.html'>Plot</a></span>(<span class='no'>rasAbundance</span>, <span class='kw'>addTo</span> <span class='kw'>=</span> <span class='st'>"rasAbundance"</span>, <span class='kw'>cols</span> <span class='kw'>=</span> <span class='st'>"black"</span>, <span class='kw'>title</span> <span class='kw'>=</span> <span class='st'>""</span>)
  }</div><div class='input'>
</div><span class='co'># NOT RUN {</span>
  <span class='co'>#########################################</span>
  <span class='co'># save iterations to a stack to make animated GIF</span>
  <span class='co'>########################################</span>
  <span class='no'>tmpStack</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>raster</span><span class='kw ns'>::</span><span class='fu'><a href='https://www.rdocumentation.org/packages/raster/topics/rasterTmpFile'>rasterTmpFile</a></span>(<span class='st'>"stackToAnimate"</span>)
  <span class='no'>out</span> <span class='kw'>&lt;-</span> <span class='fu'>spread3</span>(<span class='kw'>rasAbundance</span> <span class='kw'>=</span> <span class='no'>rasAbundance</span>,
                 <span class='kw'>rasQuality</span> <span class='kw'>=</span> <span class='no'>rasQuality</span>,
                 <span class='kw'>advectionDir</span> <span class='kw'>=</span> <span class='no'>advectionDir</span>,
                 <span class='kw'>advectionMag</span> <span class='kw'>=</span> <span class='no'>advectionMag</span>,
                 <span class='kw'>meanDist</span> <span class='kw'>=</span> <span class='fl'>2600</span>, <span class='kw'>verbose</span> <span class='kw'>=</span> <span class='fl'>2</span>,
                 <span class='kw'>plot.it</span> <span class='kw'>=</span> <span class='fl'>0</span>, <span class='kw'>saveStack</span> <span class='kw'>=</span> <span class='no'>tmpStack</span>)

  <span class='co'>## This animates the series of images into an animated GIF</span>
  <span class='kw'>if</span> (<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/library'>require</a></span>(<span class='no'>animation</span>)) {
    <span class='no'>out2</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>raster</span><span class='kw ns'>::</span><span class='fu'><a href='https://www.rdocumentation.org/packages/raster/topics/stack'>stack</a></span>(<span class='no'>tmpStack</span>)
    <span class='no'>gifName</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/file.path'>file.path</a></span>(<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/tempfile'>tempdir</a></span>(), <span class='st'>"animation.gif"</span>)
    <span class='fu'><a href='https://www.rdocumentation.org/packages/animation/topics/saveGIF'>saveGIF</a></span>(<span class='kw'>interval</span> <span class='kw'>=</span> <span class='fl'>0.1</span>, <span class='kw'>movie.name</span> <span class='kw'>=</span> <span class='no'>gifName</span>, <span class='kw'>expr</span> <span class='kw'>=</span> {
      <span class='kw'>for</span> (<span class='no'>i</span> <span class='kw'>in</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/seq'>seq</a></span>(<span class='fu'><a href='http://quickplot.predictiveecology.org//reference/numLayers.html'>numLayers</a></span>(<span class='no'>out2</span>))) <span class='fu'><a href='https://www.rdocumentation.org/packages/raster/topics/plot'>plot</a></span>(<span class='no'>out2</span><span class='kw'>[[</span><span class='no'>i</span>]])
    })
  }
<span class='co'># }</span></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      
      <li><a href="#value">Value</a></li>
      
      <li><a href="#examples">Examples</a></li>
    </ul>

  </div>
</div>

      <footer>
      <div class="copyright">
  <p>Developed by Alex M Chubaty, Eliot J B McIntire.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.3.0.</p>
</div>
      </footer>
   </div>

  

  </body>
</html>

